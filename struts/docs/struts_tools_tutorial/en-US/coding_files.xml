<?xml version='1.0' encoding='UTF-8'?>
<chapter id="coding_files" xreflabel="coding_files">
    <?dbhtml filename="coding_files.html"?>
    <chapterinfo>
        <keywordset>
            <keyword>JBoss Tools</keyword>
            <keyword>Struts</keyword>
            <keyword>Struts Application</keyword>
        </keywordset>
    </chapterinfo>

        <title>Coding the Various Files</title>
        <para>We will now code both the Java stub classes just generated, the JSP files left in as
            placeholders from previous steps, and a new start JSP page we will have to create.</para>
        <section id="JavaStubClasses">
            <title>Java Stub Classes</title>
            <itemizedlist>
                <listitem>
                    <para>To finish the two Java classes, switch to the <emphasis>
                            <property>Package Explorer</property>
                        </emphasis> view and expand the <emphasis>
                            <property>JavaSource > sample</property>
                        </emphasis> folder</para>
                </listitem>
            </itemizedlist>
            <section id="GetNameForm.java">
                <title>GetNameForm.java</title>
                <itemizedlist>
                    <listitem>
                        <para>Double-click <emphasis>
                                <property>GetNameForm.java</property>
                            </emphasis> for editing</para>
                    </listitem>

                    <listitem>
                        <para>You are looking at a Java stub class that was generated by JBoss
                            Tools. Now we are going to edit the file</para>
                    </listitem>

                    <listitem>
                        <para>Add the following attributes at the beginning of the class:</para>
                    </listitem>
                </itemizedlist>
                <programlisting role="JAVA"><![CDATA[private String name = "";
]]></programlisting>

                <itemizedlist>
                    <listitem>
                        <para>Inside the reset method, delete the TO DO and throw lines and
                        add:</para>
                    </listitem>
                </itemizedlist>
                <programlisting role="JAVA"><![CDATA[this.name = "";
]]></programlisting>

                <itemizedlist>
                    <listitem>
                        <para>Inside the validate method, delete the TO DO and throw lines and
                        add:</para>
                    </listitem>
                </itemizedlist>
                <programlisting role="JAVA"><![CDATA[ActionErrors errors = new ActionErrors();
     return errors;
]]></programlisting>

                <itemizedlist>
                    <listitem>
                        <para>Right-click and select <emphasis>
                                <property>Source > Generate Getters and Setters</property>
                            </emphasis>from the context menu</para>
                    </listitem>
                    <listitem>
                        <para>In the dialog box, check the check box for <emphasis>
                            <property>name</property>,</emphasis>
                            select First method for Insertion point, and click on the <emphasis>
                                <property>OK</property>
                            </emphasis> button</para>
                    </listitem>
                </itemizedlist>
                <para>The final <emphasis>
                    <property>GetNameForm.java</property></emphasis> file should look like this:</para>
                <programlisting role="JAVA"><![CDATA[package sample;
import javax.servlet.http.HttpServletRequest;
import org.apache.struts.action.ActionErrors;
import org.apache.struts.action.ActionMapping;

public class GetNameForm extends org.apache.struts.action.ActionForm 
{
	
	private String name = "";
	
	public String getName() 
	{
		return name;
	}
	public void setName(String name) 
	{
		this.name = name;
	}
	
	public GetNameForm() 
	{
	}
	
	public void reset(ActionMapping actionMapping, HttpServletRequest request) 
	{
		this.name = "";
	}
	
	public ActionErrors validate(ActionMapping actionMapping, 
	        HttpServletRequest request) 
	{
		ActionErrors errors = new ActionErrors();
		return errors;
	}
}
]]></programlisting>

                <itemizedlist>
                    <listitem>
                        <para>Save the file</para>
                    </listitem>
                </itemizedlist>
            </section>
            <section id="GreetingAction.java">
                <title>GreetingAction.java</title>
                <itemizedlist>
                    <listitem>
                        <para>Open <emphasis>
                            <property>GreetingAction.java</property></emphasis> for editing</para>
                    </listitem>
                    <listitem>
                        <para>Inside the execute method, delete the TO DO lines and add the
                            following:</para>
                    </listitem>
                </itemizedlist>

                <programlisting role="JAVA"><![CDATA[String name = ((GetNameForm)form).getName();
String greeting = "Hello, "+name+"!";
((GetNameForm)form).setName(greeting);
return mapping.findForward(FORWARD_sayHello);
]]></programlisting>

                <para>The final version of <emphasis>
                    <property>GreetingAction.java</property></emphasis> should look like this:</para>

                <programlisting role="JAVA"><![CDATA[package sample;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;

public class GreetingAction extends org.apache.struts.action.Action 
{
	
	// Global Forwards
	public static final String GLOBAL_FORWARD_getName = "getName";
	
	// Local Forwards
	public static final String FORWARD_sayHello = "sayHello";
	
	public GreetingAction() 
	{
	}
	public ActionForward execute(ActionMapping mapping, ActionForm form,
	HttpServletRequest request, HttpServletResponse response) throws Exception 
	{
		String name = ((GetNameForm)form).getName();
		String greeting = "Hello, "+name+"!";
		((GetNameForm)form).setName(greeting);
		return mapping.findForward(FORWARD_sayHello);
	}
}
]]></programlisting>
                <itemizedlist>
                    <listitem>
                        <para>Save the file</para>
                    </listitem>
                    <listitem>
                        <para>Close the editors for the two Java files</para>
                    </listitem>
                </itemizedlist>
                <para>The last thing left to do is to code the JSP files whose editors should still
                    be open from having been created as placeholders.</para>
            </section>
        </section>
        <section id="JSPPages">
            <title>JSP Pages</title>
            <section id="inputname.jsp">
                <title>inputname.jsp</title>
                <para>In this page, the user will enter any name and click the <emphasis>
                        <property>submit</property>
                    </emphasis> button. Then, the greeting action will be called through the form.</para>
                <itemizedlist>
                    <listitem>
                        <para>Click on the <emphasis>
                                <property>inputname.jsp</property>
                            </emphasis> tab in the Editing area to bring its editor forward</para>
                    </listitem>
                    <listitem>
                        <para>In the Web Projects view, expand <emphasis>
                                <property>StrutsHello &gt; Configuration &gt; default
                                    &gt; struts-config.xml &gt; action-mappings</property>
                            </emphasis> and select <emphasis>
                                <property>/greeting</property>
                            </emphasis></para>
                    </listitem>
                    <listitem>
                        <para>Drag it and drop it between the quotes for the <emphasis role="italic">
                                <property>&quot;action&quot;</property>
                            </emphasis> attribute to the 
                                <code>&lt;html:form&gt;</code>
                            element in the Source pane of the editor</para>
                    </listitem>
                    <listitem>
                        <para>Then type this text on a new line just below this line:</para>
                        <programlisting role="XML"><![CDATA[Input name:
                        ]]></programlisting>
                    </listitem>

                    <listitem>
                        <para>Select the <emphasis>
                                <property>Visual</property>
                            </emphasis> pane of the editor</para>
                    </listitem>
                    <listitem>
                        <para>Then, in the JBoss Tools Palette, expand the <emphasis>
                                <property>Struts Form</property>
                            </emphasis> library, select <emphasis>
                                <property>text</property>
                            </emphasis>, and drag it onto the box
                            <note>
                                <title>Note:</title>
                                <para>By default there are only four groups on the JBoss Tools
                                    Palette. If you wish to make some group visible click the <emphasis>
                                        <property>Show/Hide</property>
                                    </emphasis> button on the top of palette and in the prompted
                                    dialog check the group (or groups) you want to be shown.</para>
                            </note>
                        </para>
                    </listitem>
                </itemizedlist>
                <figure>
                    <title>JBoss Tools Palette</title>
                    <mediaobject>
                        <imageobject>
                            <imagedata fileref="images/struts_application/struts_application_3.png"
                            />
                        </imageobject>
                    </mediaobject>
                </figure>
                <itemizedlist>
                    <listitem>
                        <para>In the Insert Tag dialog box, type in name for property and select <emphasis>
                                <property>Finish</property>
                            </emphasis></para>
                    </listitem>
                    <listitem>
                        <para>In the StrutsForm library in the <property>JBoss Tools Palette</property>, select <emphasis>
                                <property>submit</property>
                            </emphasis>, and drag it to right after the text box in the Visual pane
                            of the editor</para>
                    </listitem>
                    <listitem>
                        <para>Right-click the <emphasis>
                                <property>submit</property>
                            </emphasis> button and select 
                                <code>&lt;html:submit&gt;</code>
                             Attributes from the context menu</para>
                    </listitem>
                    <listitem>
                        <para>In the Attributes dialog box, select the <emphasis>
                                <property>value</property>
                            </emphasis> field and type in &quot;Say Hello!&quot; for its
                            value</para>
                    </listitem>
                </itemizedlist>
                <para>After tidying the page source, the Editor window for the file should look
                    something like this:</para>
                <figure>
                    <title>Editor Window</title>
                    <mediaobject>
                        <imageobject>
                            <imagedata fileref="images/struts_application/struts_application_4.png"
                            />
                        </imageobject>
                    </mediaobject>
                </figure>
            </section>
            <section id="greeting.jsp">
                <title>greeting.jsp</title>
                <para>Next, we will fill in the result page.</para>
                <itemizedlist>
                    <listitem>
                        <para>Click on the <emphasis>
                                <property>greeting.jsp</property>
                            </emphasis> tab in the Editing area to bring its editor forward</para>
                    </listitem>
                    <listitem>
                        <para>Type in the following code:</para>
                    </listitem>
                </itemizedlist>
                <programlisting role="XML"><![CDATA[<html>
<head>
	<title>Greeting</title>
</head>
	<body>
		<p>
		</p>
	</body>
</html>
]]></programlisting>

                <para>To complete editing of this file, we will use macros from the <property>JBoss Tools
                    Palette</property>. This palette is a view that should be available to the right of the
                    editing area.</para>
                <itemizedlist>
                    <listitem>
                        <para>Click on the <emphasis>
                                <property>Struts Common</property>
                            </emphasis> folder in the <property>JBoss Tools Palette</property> to open it</para>
                    </listitem>
                    <listitem>
                        <para>Position the cursor at the beginning of the <emphasis>
                            <property>greeting.jsp</property></emphasis> file in the
                            Source pane and then click on <emphasis>
                                <property>bean taglib</property></emphasis> in the <property>JBoss Tools
                        Palette</property></para>
                    </listitem>
                </itemizedlist>
                <para>This will insert the following line at the top of the file:</para>
                <programlisting role="JAVA"><![CDATA[
<%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %>
]]></programlisting>
                <itemizedlist>
                    <listitem>
                        <para>Click on the <emphasis>
                                <property>Struts Bean</property>
                            </emphasis> folder in the <property>JBoss Tools Palette</property> to open it</para>
                    </listitem>
                    <listitem>
                        <para>Position the cursor inside the 
                                <code>&lt;p&gt;</code>
                            element</para>
                    </listitem>
                    <listitem>
                        <para>Click on <emphasis>
                            <property>write</property></emphasis> in the <property>JBoss Tools Palette</property></para>
                    </listitem>
                    <listitem>
                        <para>Type in &quot;GetNameForm&quot; for the <emphasis
                                role="italic">
                                <property>name</property>
                            </emphasis> attribute and add a <emphasis role="italic">
                                <property>property</property>
                            </emphasis> attribute with &quot;name&quot; as its
                        value</para>
                    </listitem>
                </itemizedlist>
                <para>The editor should now look like this:</para>
                <figure>
                    <title>Editor Window</title>
                    <mediaobject>
                        <imageobject>
                            <imagedata fileref="images/struts_application/struts_application_5.png"
                            />
                        </imageobject>
                    </mediaobject>
                </figure>
            </section>
            <section id="index.jsp">
                <title>index.jsp</title>
                <para>Finally, we will need to create and edit an <emphasis>
                    <property>index.jsp</property></emphasis> page. This page will use
                    a Struts forward to simply redirect us to the getName global forward.</para>
                <itemizedlist>
                    <listitem>
                        <para>In the Web Projects view, right-click on <emphasis>
                                <property>StrutsHello > WEB-ROOT(WebContent)</property>
                            </emphasis> node and select <emphasis>
                                <property>New > File > JSP</property>
                            </emphasis></para>
                    </listitem>
                    <listitem>
                        <para>Type <emphasis>
                            <property>index</property></emphasis> for Name and click on the <emphasis>
                                <property>Finish</property>
                            </emphasis> button</para>
                    </listitem>
                    <listitem>
                        <para>On the <property>JBoss Tools Palette</property>, select the <emphasis>
                                <property>Struts Common</property>
                            </emphasis> folder of macros by clicking on it in the palette</para>
                    </listitem>
                    <listitem>
                        <para>Click on the <emphasis>
                            <property>logic taglib</property></emphasis> icon</para>
                    </listitem>
                    <listitem>
                        <para>Press the <emphasis>
                                <property>Enter</property>
                            </emphasis> key in the editor to go to the next line</para>
                    </listitem>
                    <listitem>
                        <para>Back on the palette, select the <emphasis>
                                <property>Struts Logic</property>
                            </emphasis> folder of macros</para>
                    </listitem>
                    <listitem>
                        <para>Click on <emphasis>
                            <property>redirect</property></emphasis></para>
                    </listitem>
                    <listitem>
                        <para>Delete the ending tag, put a forward slash in front of the closing
                            angle bracket, and type &quot;forward=getName&quot; in front of
                            the slash</para>
                    </listitem>
                </itemizedlist>
                <para>The finished code for the page is shown below:</para>
                <programlisting role="JAVA"><![CDATA[<%@ taglib uri="/WEB-INF/struts-logic.tld" prefix="logic" %>
<logic:redirect forward="getName"/>
]]></programlisting>
                <itemizedlist>
                    <listitem>
                        <para>To save all the edits to files, select <emphasis>
                                <property>File>Save All</property>
                            </emphasis> from the menu bar</para>
                    </listitem>
                </itemizedlist>
            </section>
        </section>
    </chapter>